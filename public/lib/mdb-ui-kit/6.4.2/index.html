
<!DOCTYPE html>
<html>

<head>
    <!-- PotatoUtils全局配置 -->
<script>
  var puVersion = "0.5.0"
</script>

<!-- CSS -->
<!-- <link rel="stylesheet" href="https://cdnjs.akyuu.cn/libs/bootstrap/5.3.2/css/bootstrap.min.css" /> -->
<link rel="stylesheet" href="../lib/font-awesome.css" />
<link rel="stylesheet" href="css/mdb.min.css" />
<link rel="stylesheet" href="../lib/animate.css" />


<!-- JavaScript -->
<!-- <script type="text/javascript" src="https://cdnjs.akyuu.cn/libs/bootstrap/5.3.2/js/bootstrap.min.js"></script> -->
<script type="text/javascript" src="js/mdb.min.js"></script>
<script type="text/javascript" src="../lib/font-awesome.js"></script>

<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<link rel="shortcut icon" href="../resources/logo.ico">
        <title>HUB | Potato Utils</title>

</head>

<body>
    <header>
        <nav class="navbar navbar-expand-lg mb-3">
    <div class="container-fluid mt-0 mb-0 ms-2 me-2">
        <a class="navbar-brand mt-2 me-3 mt-lg-0 text-center" href="/">
            <img src="../resources/logo.ico" style="max-width: 32px;"></img>&nbsp;&nbsp;Potato Utils
        </a>
        <button class="navbar-toggler" type="button" data-mdb-toggle="collapse"
            data-mdb-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
            aria-label="Toggle navigation">
            <i class="navbar-brand fa-solid fa-bars"></i>
        </button>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                <li class="nav-item">
                    <a class="nav-link" href="/">主页</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="/stats">统计</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="https://akyuu.cn/">传送门</a>
                </li>
            </ul>
            <div class="d-flex align-items-center">
                <a id="dark-mode-switch" data-mdb-toggle="tooltip2" title="切换深色模式" onclick="darkModeSwitch();buttonClickAnimation(this)">
                    <i class="fa-solid fa-circle-half-stroke fa-xl pu-navbar-icon"></i>
                </a>
                &nbsp;&nbsp;&nbsp;&nbsp;
                <a id="github-icon" data-mdb-toggle="tooltip1" title="Github 仓库" onclick="buttonClickAnimation(this)"
                    href="https://github.com/akyuu-cn/PotatoUtils">
                    <i class="fa-brands fa-github fa-xl pu-navbar-icon" style="color:#000"></i>
                </a>
            </div>
        </div>
    </div>
</nav>

<!-- 深色模式脚本 -->
<script>

    // 在网页加载时读取深色模式配置并决定是否切换

    if (localStorage.getItem('isDarkModeOn') == "true") { // localStorage 里存的是 string
        document.body.classList.add('pu-dark')
    }

    // 深色模式切换按钮
    function darkModeSwitch(){
        if (localStorage.getItem('isDarkModeOn') == "true") {
            document.body.classList.remove('pu-dark')
            localStorage.setItem('isDarkModeOn', false)
        } else {
            document.body.classList.add('pu-dark')
            localStorage.setItem('isDarkModeOn', true)
        }
    }

</script>

<!-- 杂项脚本 -->
<script>

    // 按钮点击反馈动画
    function buttonClickAnimation(elem){
        elem.firstElementChild.classList.add('pu-button-animation')
    }
</script>
    </header>

    <div class="container-md mb-3">
        <button type="button" id="type-switcher-all" class="btn btn-primary" data-mdb-ripple-init
            data-mdb-ripple-color="dark" style="font-size: 15px;font-weight:bold;" onclick="switcherAll()">显示所有</button>
        &nbsp;
        <button type="button" id="type-switcher-utils" class="btn btn-outline-success" data-mdb-ripple-init
            data-mdb-ripple-color="dark" style="font-size: 15px" onclick="switcherUtils()">实用工具</button>
        <button type="button" id="type-switcher-measure" class="btn btn-outline-danger" data-mdb-ripple-init
            data-mdb-ripple-color="dark" style="font-size: 15px" onclick="switcherMeasure()">测算工具</button>
        <button type="button" id="type-switcher-special" class="btn btn-outline-warning" data-mdb-ripple-init
            data-mdb-ripple-color="dark" style="font-size: 15px" onclick="switcherSpecial()">有意思的小玩意</button>
        <!-- <button type="button" class="btn btn-outline-info" data-mdb-ripple-init data-mdb-ripple-color="dark"
            style="font-size: 15px">Info</button>
        <button type="button" class="btn btn-outline-light" data-mdb-ripple-init data-mdb-ripple-color="dark"
            style="font-size: 15px">Light</button>
        <button type="button" class="btn btn-outline-dark" data-mdb-ripple-init data-mdb-ripple-color="dark"
            style="font-size: 15px">Dark</button> -->
    </div>

    <div class="container-md mb-3">
        <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-3" id="utils-container">

            <h3 style="text-align: center;width: 100%;opacity: 50%;" class="mt-5">一切皆已遁入幻想</h3>

        </div>

    </div>

    <footer>
        <div class="text-muted pu-footer d-flex" id="pu-footer">
    <div class="me-auto ms-4" id="pu-version"></div>
    <div class="ms-auto me-4" id="pu-slogan"></div>
</div>


<script>
    (async function () {
        document.getElementById("pu-version").innerText = `PotatoUtils v${puVersion}`

        function isPhone() {
            const info = navigator.userAgent
            const isPhone = /mobile/i.test(info)
            return isPhone
        }

        // hitokoto
        if (!isPhone()) {
            const response = await fetch('https://v1.hitokoto.cn?c=a&c=b&c=c&c=d&c=e&c=f&c=g&c=h&c=i&c=j&c=k&max_length=15')
            const { uuid, hitokoto: hitokotoText } = await response.json()
            const hitokoto = document.getElementById("pu-slogan")
            hitokoto.href = `https://hitokoto.cn/?uuid=${uuid}`
            hitokoto.innerText = hitokotoText
        }


    })()
</script>


<style>
    .pu-footer {
        position: absolute;
        bottom: 0;
        width: 100%;
        height: 2.5rem;
        font-size: 1rem;
    }

    body {
        position: relative;
        min-height: 100vh;
        padding-bottom: 2.5rem;
    }

    /* 滚动条样式 */
    ::-webkit-scrollbar {
        width: 6px;
        height: 10px;
        background-color: var(--pu-body-bg-color);
        border-radius: 5px;
    }

    ::-webkit-scrollbar-thumb {
        background-color: #8b8b8b;
        border-radius: 5px;
    }


    ::-webkit-scrollbar-track {
        background-color: var(--pu-body-bg-color);
        border-radius: 5px;
    }
</style>

<!-- 深色模式 -->
<style>
    /* 默认情况下应用浅色样式 */
    body {
        --pu-text: #000;
        --pu-hover: #555;
        --pu-text-muted: #757575;
    }

    /* 深色样式 */
    body.pu-dark {
        --pu-body-bg-color: #222;
        --pu-navbar-bg-color: #282828;
        --pu-card-bg-color: #444;
        --pu-text: #FFF;
        --pu-hover: #D0D0D0;
        --pu-btn-bg-color: #78aaff;
        --pu-btn-bg-color-hover: #aac9ff;
        --pu-text-muted: #a2a2a2;
        --pu-readonly-bg-color: #222222;
    }

    body {
        background-color: var(--pu-body-bg-color);
        color: var(--pu-text);
        transition-duration: 300ms !important;
    }

    .navbar {
        background-color: var(--pu-navbar-bg-color);
        transition-duration: 300ms !important;
    }

    .navbar-brand {
        color: var(--pu-text);
        transition-duration: 300ms !important;
    }

    .navbar-brand:hover {
        color: var(--pu-hover);
        transition-duration: 300ms !important;
    }

    .nav-link {
        color: var(--pu-text);
        transition-duration: 300ms !important;
    }

    .nav-link:hover {
        color: var(--pu-hover);
        transition-duration: 300ms !important;
    }

    .pu-navbar-icon {
        color: var(--pu-text) !important;
        transition-duration: 300ms !important;
    }

    .pu-navbar-icon:hover {
        color: var(--pu-hover) !important;
        transition-duration: 300ms !important;
    }



    .card {
        background-color: var(--pu-card-bg-color);
        transition-duration: 300ms !important;
    }


    .form-label {
        color: var(--pu-text) !important;
        transition-duration: 300ms !important;
    }

    .form-control {
        color: var(--pu-hover) !important;
        transition-duration: 300ms !important;
    }

    .table {
        color: var(--pu-text);
        transition-duration: 300ms !important;
    }

    .btn-outline-secondary {
        color: var(--pu-btn-bg-color);
        transition-duration: 300ms !important;
    }

    .btn-outline-secondary:hover {
        color: var(--pu-btn-bg-color-hover);
        transition-duration: 300ms !important;
    }

    .text-muted {
        color: var(--pu-text-muted) !important;
        transition-duration: 300ms !important;
    }

    .form-control[readonly]{
        background-color: var(--pu-readonly-bg-color) !important;
        transition-duration: 300ms !important;
    }
</style>

<!-- 动画 -->
<style>
    @keyframes pulse {
        0% {
            transform: scale(1);
        }

        50% {
            transform: scale(1.2);
        }

        100% {
            transform: scale(1);
        }
    }

    .pu-button-animation {
        animation-name: pulse;
        animation-duration: 0.5s;
    }
</style>
    </footer>

    <script>
        var utilsList, typeList
        Promise.all([
            fetch("../data/index/utils_list.json"),
            fetch("../data/index/type_list.json")
        ])
            .then(([utils, types]) => {
                Promise.all([utils.json(), types.json()])
                    .then(([utils, types]) => {
                        utilsList = utils
                        typeList = types
                        switcherAll() //默认开启全部分类
                    })
            })
            .catch(err => console.error('One or more requests failed', err))

        // (async function () {
        //     fetch("../data/index/utils_list.json")
        //         .then(response => response.json())
        //         .then(json => utilsList = json)
        //         .catch(err => console.log('Data Request Failed', err))
        //     fetch("../data/index/type_list.json")
        //         .then(response => response.json())
        //         .then(json => typeList = json)
        //         .catch(err => console.log('Data Request Failed', err))
        // })().then(
        //     switcherAll() //默认开启全部分类
        // )

        var elementSwitcherAll = document.getElementById("type-switcher-all")
        var elementSwitcherUtils = document.getElementById("type-switcher-utils")
        var elementSwitcherMeasure = document.getElementById("type-switcher-measure")
        var elementSwitcherSpecial = document.getElementById("type-switcher-special")

        var typeArray = ["utils", "measure", "special"]

        function checkIfAllSwitcherOn() {
            let tf = true
            typeArray.forEach(type => {
                if (!document.getElementById(`type-switcher-${type}`).isOn) {
                    tf = false
                }
            })
            if (tf) {
                openAll()
            }

        }

        function openSwitcher(type) {
            let e = document.getElementById(`type-switcher-${type}`)
            if (!e.isOn) { e.click() }
        }

        function closeSwitcher(type) {
            let e = document.getElementById(`type-switcher-${type}`)
            if (e.isOn) { e.click() }
        }

        function switcherAll() { //切换所有标签的状态
            let e = elementSwitcherAll
            e.isOn = !e.isOn
            if (e.isOn) {
                e.classList.replace("btn-outline-primary", "btn-primary")
                e.innerText = "隐藏所有"
                typeArray.forEach(type => {
                    openSwitcher(type)
                })
            } else {
                e.classList.replace("btn-primary", "btn-outline-primary")
                e.innerText = "显示所有"
                typeArray.forEach(type => {
                    closeSwitcher(type)
                })
            }
            renderUtilsList()
        }

        function closeAll() { //仅关闭All标签的状态，不影响其他标签
            let e = elementSwitcherAll
            e.isOn = false
            e.classList.replace("btn-primary", "btn-outline-primary")
            e.innerText = "显示所有"
            renderUtilsList()
        }

        function openAll() { //仅开启All标签的状态，不影响其他标签
            let e = elementSwitcherAll
            e.isOn = true
            e.classList.replace("btn-outline-primary", "btn-primary")
            e.innerText = "隐藏所有"
            renderUtilsList()
        }

        function switcherUtils() {
            let e = elementSwitcherUtils
            e.isOn = !e.isOn
            if (e.isOn) {
                e.classList.replace("btn-outline-success", "btn-success")
            } else {
                e.classList.replace("btn-success", "btn-outline-success")
                closeAll()
            }
            checkIfAllSwitcherOn()
            renderUtilsList()
        }

        function switcherMeasure() {
            let e = elementSwitcherMeasure
            e.isOn = !e.isOn
            if (e.isOn) {
                e.classList.replace("btn-outline-danger", "btn-danger")
            } else {
                e.classList.replace("btn-danger", "btn-outline-danger")
                closeAll()
            }
            checkIfAllSwitcherOn()
            renderUtilsList()
        }

        function switcherSpecial() {
            let e = elementSwitcherSpecial
            e.isOn = !e.isOn
            if (e.isOn) {
                e.classList.replace("btn-outline-warning", "btn-warning")
            } else {
                e.classList.replace("btn-warning", "btn-outline-warning")
                closeAll()
            }
            checkIfAllSwitcherOn()
            renderUtilsList()
        }

        function renderUtilsList() {
            var typeSwitcher = []
            for (let i = 0; i < typeList.length; i++) {
                typeSwitcher[i] = { "id": typeList[i].id, "isOn": false }
            }

            function activateType(typeId) {
                typeSwitcher = typeSwitcher.map(type => {
                    if (type.id === typeId) {
                        return { ...type, isOn: true } // 使用展开运算符创建一个新对象，修改 isOn 属性为 true
                    }
                    return type // 对于不需要修改的元素，直接返回原始元素
                })
            }

            if (document.getElementById("type-switcher-all").isOn) {
                activateType("all")
            }
            if (document.getElementById("type-switcher-utils").isOn) {
                activateType("utils")
            }
            if (document.getElementById("type-switcher-measure").isOn) {
                activateType("measure")
            }
            if (document.getElementById("type-switcher-special").isOn) {
                activateType("special")
            }

            let ucStr = ""
            utilsList.forEach(util => {
                let typeDisplay
                let type = typeSwitcher.find(type => (type.id === util.type) && (type.isOn))
                if (type) {
                    typeDisplay = typeList.find(type => type.id === util.type).display
                    ucStr += `
<div class="col">
    <div class="card" style="height:100%">
        <div class="card-body d-flex flex-column">
            <h4 class="card-title mb-3">
                <i class="${util.icon}"></i> ${util.title}
            </h4>
            <p class="card-text mt-0">
                ${util.description}
            </p>    
            <div class="mt-auto d-flex">
                <button type="button" class="btn btn-primary" style="font-size: 15px"
                    onclick="window.location.href='/utils/${util.id}'">跳转</button>
                <span class="ms-auto align-self-end" style="opacity: 50%;">${typeDisplay}</span>
            </div>
        </div>
    </div>
</div>
                    `
                }
            })

            let uc = document.getElementById("utils-container")

            if (ucStr == "") {
                ucStr = `<h3 style="text-align: center;width: 100%;opacity: 50%;" class="mt-5">一切皆已遁入幻想</h3>`
            }

            uc.innerHTML = ucStr


        }

    </script>

</body>

</html>